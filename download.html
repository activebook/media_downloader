<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Download Progress</title>
    <link href="tailwind.min.css" rel="stylesheet">
    <style>
        body {
            min-width: 400px;
            height: 300px;
            /* Fixed height to match popup */
            overflow-y: auto;
        }

        .progress-bar {
            width: 0%;
        }

        /* Custom header style for the title bar */
        .custom-header-style {
          background: linear-gradient(to right, #f9fafb, #f3f4f6), radial-gradient(circle at 25% 25%, rgba(17, 24, 39, 0.05) 0%, transparent 50%), radial-gradient(circle at 75% 75%, rgba(17, 24, 39, 0.05) 0%, transparent 50%);
          background-blend-mode: multiply;
          color: #374151;
          box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06), 0 1px 3px 0 rgba(0, 0, 0, 0.1);
        }

        /* Custom scrollbar for WebKit */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        ::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
    </style>
</head>

<body class="m-0 p-4 bg-gray-50 text-gray-800 font-sans">
    <div class="flex flex-col h-full relative">
        <!-- Header -->
        <div class="flex justify-between items-center p-2 -mx-4 -mt-4 mb-4 shadow-sm shadow-b-md custom-header-style">
            <div class="flex items-baseline">
                <h1 class="text-base font-bold ml-2">Downloading...</h1>
            </div>
        </div>

        <!-- Main Content -->
        <div id="mainContent" class="flex-1 p-4 flex flex-col justify-center items-center text-center space-y-4">

            <!-- File Info -->
            <div class="w-full text-left">
                <h2 id="filename" class="text-sm font-medium text-gray-700 truncate mb-1">video.ts</h2>
                <div class="text-xs text-gray-500 truncate" id="url">http://example.com/video.m3u8</div>
            </div>

            <!-- Progress Circle or Bar -->
            <div class="w-full relative pt-1">
                <div class="flex mb-2 items-center justify-between">
                    <div>
                        <span
                            class="text-xs font-semibold inline-block py-1 px-2 uppercase rounded-full text-blue-600 bg-blue-200"
                            id="statusBadge">
                            Downloading
                        </span>
                    </div>
                    <div class="text-right">
                        <span class="text-xs font-semibold inline-block text-blue-600" id="percentage">
                            0%
                        </span>
                    </div>
                </div>
                <div class="overflow-hidden h-2 mb-4 text-xs flex rounded bg-blue-200">
                    <div id="progressBar"
                        class="progress-bar shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-blue-500 transition-all duration-500">
                    </div>
                </div>
                <div class="flex justify-between text-xs text-gray-500">
                    <span id="downloadedSegments">0 segments</span>
                    <span id="totalSegments">Loading...</span>
                </div>
            </div>

            <!-- Error Message (Hidden by default) -->
            <div id="errorSection"
                class="hidden w-full bg-red-50 border border-red-200 text-red-600 p-3 rounded-md text-sm text-left">
                <p class="font-bold">Error:</p>
                <p id="errorMessage" class="break-words mt-1">Unknown error</p>
            </div>

            <!-- Actions -->
            <div class="w-full flex gap-3 mt-4">
                <button id="cancelBtn"
                    class="flex-1 px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                    Cancel
                </button>
            </div>

        </div>

        <!-- Done State (Hidden by default) -->
        <div id="doneSection" class="flex-1 p-4 flex flex-col justify-center items-center text-center">
            <div class="mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100 mb-4">
                <svg class="h-6 w-6 text-green-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                </svg>
            </div>
            <h3 class="text-lg leading-6 font-medium text-gray-900">Download Complete!</h3>
            <p class="mt-2 text-sm text-gray-500">
                Your video has been downloaded successfully.
            </p>
            <button id="backBtn"
                class="mt-6 w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:text-sm">
                Back to Media List
            </button>
        </div>
    </div>
    <script src="logger.js"></script>
    <script src="common.js"></script>
    <script src="download_state.js"></script>
    <script src="download.js"></script>
</body>

</html>